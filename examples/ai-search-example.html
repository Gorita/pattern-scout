<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pattern Scout - AI ê²€ìƒ‰ ì˜ˆì œ</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: #0d1117;
      color: #c9d1d9;
    }

    h1 {
      color: #58a6ff;
    }

    .search-box {
      width: 100%;
      padding: 15px;
      font-size: 16px;
      border: 2px solid #30363d;
      border-radius: 8px;
      background: #161b22;
      color: #c9d1d9;
      margin-bottom: 20px;
    }

    button {
      padding: 12px 24px;
      font-size: 16px;
      background: #238636;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    button:hover {
      background: #2ea043;
    }

    button:disabled {
      background: #484f58;
      cursor: not-allowed;
    }

    .result {
      margin-top: 20px;
      padding: 20px;
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 8px;
      white-space: pre-wrap;
    }

    .error {
      color: #f85149;
    }

    .warning {
      padding: 15px;
      background: #1e2a3a;
      border-left: 4px solid #58a6ff;
      margin-bottom: 20px;
      border-radius: 4px;
    }

    code {
      background: #0d1117;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'SF Mono', Monaco, monospace;
    }
  </style>
</head>
<body>
  <h1>ğŸ” Pattern Scout - AI ê²€ìƒ‰ ì˜ˆì œ</h1>

  <div class="warning">
    âš ï¸ <strong>ì´ ì˜ˆì œëŠ” í”„ë¡œí† íƒ€ì…ì…ë‹ˆë‹¤.</strong><br>
    ì‹¤ì œ ì‚¬ìš©ì„ ìœ„í•´ì„œëŠ” <code>YOUR_GEMINI_API_KEY</code>ë¥¼ ì…ë ¥í•˜ì„¸ìš”.<br>
    <a href="https://aistudio.google.com/app/apikey" target="_blank" style="color: #58a6ff;">Gemini API Key ë°œê¸‰ë°›ê¸° â†’</a>
  </div>

  <input
    type="text"
    class="search-box"
    id="queryInput"
    placeholder="ì˜ˆ: ì—ì´ì „íŠ¸ê°€ ìì‹ ì˜ ì¶œë ¥ì„ ê°œì„ í•˜ëŠ” ë°©ë²•ì´ í•„ìš”í•´"
  />

  <button onclick="searchPatterns()" id="searchBtn">AIë¡œ íŒ¨í„´ ê²€ìƒ‰</button>

  <div id="result" class="result" style="display: none;"></div>

  <script type="module">
    // ì‹¤ì œ êµ¬í˜„ ì˜ˆì œ (Gemini 1.5 Flash ì‚¬ìš©)
    import { GoogleGenerativeAI } from 'https://esm.run/@google/generative-ai';

    window.searchPatterns = async function() {
      const query = document.getElementById('queryInput').value.trim();
      const resultDiv = document.getElementById('result');
      const searchBtn = document.getElementById('searchBtn');

      if (!query) {
        alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
        return;
      }

      // API í‚¤ (ì‹¤ì œë¡œëŠ” í™˜ê²½ë³€ìˆ˜ë‚˜ ì„œë²„ì—ì„œ ê´€ë¦¬)
      const API_KEY = 'YOUR_GEMINI_API_KEY'; // ì—¬ê¸°ì— ì‹¤ì œ í‚¤ ì…ë ¥

      if (API_KEY === 'YOUR_GEMINI_API_KEY') {
        resultDiv.style.display = 'block';
        resultDiv.innerHTML = '<span class="error">âš ï¸ API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”. ì½”ë“œì˜ API_KEY ë³€ìˆ˜ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”.</span>';
        return;
      }

      try {
        searchBtn.disabled = true;
        searchBtn.textContent = 'ê²€ìƒ‰ ì¤‘...';
        resultDiv.style.display = 'block';
        resultDiv.textContent = 'ğŸ”„ AIê°€ íŒ¨í„´ì„ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...';

        // 1. AI Manifest ë¡œë“œ
        const manifestResponse = await fetch('../public/ai-manifest.json');
        const manifest = await manifestResponse.json();

        // 2. ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ êµ¬ì„±
        const systemInstruction = `
You are an expert on AI Agent Design Patterns.

Here is the complete list of patterns in our database:
${JSON.stringify(manifest)}

Your task:
1. Analyze the user's problem or use case
2. Select 2-3 most relevant patterns from the list
3. For each pattern, explain:
   - WHY it fits the user's need (2-3 sentences)
   - Key benefits
   - Potential trade-offs
4. Suggest how to combine patterns if applicable

Response format (Korean):
## ì¶”ì²œ íŒ¨í„´

### 1. [íŒ¨í„´ëª…]
[ì„¤ëª…...]

### 2. [íŒ¨í„´ëª…]
[ì„¤ëª…...]

## ì¡°í•© ì œì•ˆ
[ìˆìœ¼ë©´...]

IMPORTANT: Only recommend patterns that exist in the provided list. Do not make up patterns.
`;

        // 3. Gemini í˜¸ì¶œ
        const genAI = new GoogleGenerativeAI(API_KEY);
        const model = genAI.getGenerativeModel({
          model: "gemini-1.5-flash",
          systemInstruction: systemInstruction
        });

        const result = await model.generateContent(query);
        const response = result.response.text();

        // 4. ê²°ê³¼ í‘œì‹œ
        resultDiv.textContent = response;

      } catch (error) {
        resultDiv.innerHTML = `<span class="error">âŒ ì˜¤ë¥˜: ${error.message}</span>`;
        console.error(error);
      } finally {
        searchBtn.disabled = false;
        searchBtn.textContent = 'AIë¡œ íŒ¨í„´ ê²€ìƒ‰';
      }
    };

    // Enter í‚¤ ì§€ì›
    document.getElementById('queryInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        searchPatterns();
      }
    });
  </script>

  <hr style="margin: 40px 0; border-color: #30363d;">

  <h2>ğŸ’¡ ì‚¬ìš© ì˜ˆì‹œ</h2>
  <ul>
    <li>"ì—ì´ì „íŠ¸ê°€ ìì‹ ì˜ ì¶œë ¥ì„ ê²€ì¦í•˜ê³  ê°œì„ í•˜ëŠ” ë°©ë²•ì´ í•„ìš”í•´"</li>
    <li>"ëŒ€í™”ê°€ ê¸¸ì–´ì§ˆ ë•Œ í† í° ë¹„ìš©ì„ ì¤„ì´ê³  ì‹¶ì–´"</li>
    <li>"ì—¬ëŸ¬ ì—ì´ì „íŠ¸ë¥¼ ì¡°ìœ¨í•´ì„œ ë³µì¡í•œ ì‘ì—…ì„ ì²˜ë¦¬í•˜ê³  ì‹¶ì–´"</li>
    <li>"ë³´ì•ˆì´ ì¤‘ìš”í•œ í™˜ê²½ì—ì„œ ì—ì´ì „íŠ¸ë¥¼ ì•ˆì „í•˜ê²Œ ì‹¤í–‰í•˜ë ¤ë©´?"</li>
  </ul>

  <h2>ğŸ“Š ë¹„ìš©</h2>
  <p>
    Gemini 1.5 Flash ê¸°ì¤€:<br>
    - ì…ë ¥: ~37,600 í† í° (manifest) + ì‚¬ìš©ì ì¿¼ë¦¬<br>
    - ë¹„ìš©: ì•½ $0.01/ìš”ì²­<br>
    - Context Caching ì‚¬ìš© ì‹œ: $0.001/ìš”ì²­ (90% ì ˆê°)
  </p>

  <h2>ğŸ”§ ë‹¤ìŒ ë‹¨ê³„</h2>
  <ol>
    <li><strong>Context Caching êµ¬í˜„</strong> - ë¹„ìš© 90% ì ˆê°</li>
    <li><strong>í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰</strong> - í´ë¼ì´ì–¸íŠ¸ í•„í„°ë§ + AI ì¶”ì²œ</li>
    <li><strong>ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ</strong> - ì‚¬ìš©ì ê²½í—˜ ê°œì„ </li>
    <li><strong>ëŒ€í™” ê¸°ë¡</strong> - ì´ì „ ì¶”ì²œ ê¸°ì–µ</li>
  </ol>
</body>
</html>
